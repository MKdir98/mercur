# ğŸ”’ SSL-Safe Deployment Guide

## Ù…Ø´Ú©Ù„ Ù‚Ø¨Ù„ÛŒ

Ù‚Ø¨Ù„Ø§Ù‹ ÙˆÙ‚ØªÛŒ `deploy` Ø¹Ø§Ø¯ÛŒ Ù…ÛŒâ€ŒØ²Ø¯ÛŒØ¯ØŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª SSL Ø§Ø² nginx Ø­Ø°Ù Ù…ÛŒâ€ŒØ´Ø¯ Ùˆ Ø¨Ø§ÛŒØ¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ `ssl` Ø±Ø§ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒÚ©Ø±Ø¯ÛŒØ¯.

## Ø±Ø§Ù‡ Ø­Ù„ Ø¬Ø¯ÛŒØ¯ âœ…

### Ø¯Ø³ØªÙˆØ± Ø¬Ø¯ÛŒØ¯: `update`

Ø¯Ø³ØªÙˆØ± `update` Ø¨Ø±Ø§ÛŒ **Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ø¯ Ø¨Ø¯ÙˆÙ† Ø¯Ø³Øª Ø²Ø¯Ù† Ø¨Ù‡ SSL** Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª.

```bash
sudo bash marketplace-deploy.sh update
```

#### Ú†Ù‡ Ú©Ø§Ø±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ¯Ù‡Ø¯:
âœ… Ú©Ø¯ Ø±Ø§ Ø§Ø² git Ù…ÛŒâ€ŒÚ©Ø´Ø¯ (git pull)
âœ… Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ Ø±Ø§ build Ù…ÛŒâ€ŒÚ©Ù†Ø¯
âœ… Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ÛŒ PM2 Ø±Ø§ restart Ù…ÛŒâ€ŒÚ©Ù†Ø¯
âœ… **ØªÙ†Ø¸ÛŒÙ…Ø§Øª Nginx/SSL Ø±Ø§ Ø¯Ø³Øª Ù†Ù…ÛŒâ€ŒØ²Ù†Ø¯**

---

## Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ú©Ø§Ù…Ù„

### Ø§ÙˆÙ„ÛŒÙ† Ø¨Ø§Ø± (Initial Setup):

```bash
# 1. Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ø§ÙˆÙ„ÛŒÙ‡
sudo bash marketplace-deploy.sh deploy

# 2. Ù†ØµØ¨ SSL
sudo bash marketplace-deploy.sh ssl
```

### Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ú©Ø¯ (Ù¾Ø³ Ø§Ø² Ù†ØµØ¨ SSL):

```bash
# ÙÙ‚Ø· Ú©Ø¯ Ø±Ø§ update Ú©Ù†ÛŒØ¯ (SSL Ø³Ø§Ù„Ù… Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯)
sudo bash marketplace-deploy.sh update
```

### Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ú©Ø§Ù…Ù„ Ø¯ÙˆØ¨Ø§Ø±Ù‡:

Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ **Ù‡Ù…Ù‡ Ú†ÛŒØ²** Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù†ØµØ¨ Ú©Ù†ÛŒØ¯:

```bash
# Ø¯ÛŒÙ¾Ù„ÙˆÛŒ Ú©Ø§Ù…Ù„ (nginx config Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…ÛŒâ€ŒÙ†ÙˆÛŒØ³Ø¯)
sudo bash marketplace-deploy.sh deploy

# Ø§Ú¯Ø± SSL Ø¯Ø§Ø´ØªÛŒØ¯ØŒ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù†ØµØ¨ Ú©Ù†ÛŒØ¯
sudo bash marketplace-deploy.sh ssl
```

**Ù†Ú©ØªÙ‡**: ØªØ§Ø¨Ø¹ `setup_nginx()` Ø§Ú©Ù†ÙˆÙ† Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø´Ø¯Ù‡ Ø§Ø³Øª:
- Ø§Ú¯Ø± SSL Ø¯Ø± nginx config Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ø¯ØŒ Ø¢Ù† Ø±Ø§ **preserve Ù…ÛŒâ€ŒÚ©Ù†Ø¯**
- Ù¾ÛŒØºØ§Ù… Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ú©Ù‡ config SSL Ø¯Ø§Ø±Ø¯ Ùˆ Ø¯Ø³Øª Ù†Ù…ÛŒâ€ŒØ²Ù†Ø¯

---

## Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¯Ø³ØªÙˆØ±Ø§Øª

| Ø¯Ø³ØªÙˆØ± | Ú©Ø¯ Ø±Ø§ Update Ù…ÛŒâ€ŒÚ©Ù†Ø¯ | Build Ù…ÛŒâ€ŒÚ©Ù†Ø¯ | Nginx Config | SSL | Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§ |
|-------|---------------------|--------------|--------------|-----|-----------|
| `update` | âœ… | âœ… | âŒ Ø¯Ø³Øª Ù†Ù…ÛŒâ€ŒØ²Ù†Ø¯ | âœ… Ø³Ø§Ù„Ù… Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯ | Ø³Ø±ÛŒØ¹ (~5-10 Ø¯Ù‚ÛŒÙ‚Ù‡) |
| `deploy` | âœ… | âœ… | âœ… Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù…ÛŒâ€ŒÙ†ÙˆÛŒØ³Ø¯ | âš ï¸ Ø­ÙØ¸ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ø¯ | Ú©Ø§Ù…Ù„ (~15-20 Ø¯Ù‚ÛŒÙ‚Ù‡) |
| `ssl` | âŒ | âŒ | âœ… SSL Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ | âœ… Ù†ØµØ¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ | Ø³Ø±ÛŒØ¹ (~2-5 Ø¯Ù‚ÛŒÙ‚Ù‡) |

---

## Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ Ù…Ø¹Ù…ÙˆÙ„

### 1ï¸âƒ£ ØªØºÛŒÛŒØ±Ø§Øª Ú©Ø¯ backend ÛŒØ§ frontend:
```bash
sudo bash marketplace-deploy.sh update
```

### 2ï¸âƒ£ ØªØºÛŒÛŒØ± Ø¯Ø± environment variables:
```bash
# ÙØ§ÛŒÙ„ .env Ø±Ø§ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ù†ÛŒØ¯
nano /var/www/marketplace/mercur/apps/backend/.env

# Ø³Ù¾Ø³ update Ø¨Ø²Ù†ÛŒØ¯
sudo bash marketplace-deploy.sh update
```

### 3ï¸âƒ£ Ù…Ø´Ú©Ù„ Ø¯Ø± nginx ÛŒØ§ SSL:
```bash
# config nginx Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯
sudo rm /etc/nginx/sites-available/marketplace
sudo rm /etc/nginx/sites-enabled/marketplace

# Ø¯ÙˆØ¨Ø§Ø±Ù‡ deploy Ú©Ù†ÛŒØ¯
sudo bash marketplace-deploy.sh deploy

# SSL Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù†ØµØ¨ Ú©Ù†ÛŒØ¯
sudo bash marketplace-deploy.sh ssl
```

### 4ï¸âƒ£ ÙÙ‚Ø· restart Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ (Ø¨Ø¯ÙˆÙ† build):
```bash
pm2 restart all
```

---

## Ø¯Ø³ØªÙˆØ±Ø§Øª Ù…ÙÛŒØ¯ PM2

```bash
# Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÙˆØ¶Ø¹ÛŒØª
pm2 status

# Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§
pm2 logs

# Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø§Ú¯ ÛŒÚ© Ø³Ø±ÙˆÛŒØ³ Ø®Ø§Øµ
pm2 logs backend
pm2 logs storefront
pm2 logs vendor-panel

# restart ÛŒÚ© Ø³Ø±ÙˆÛŒØ³ Ø®Ø§Øµ
pm2 restart backend

# Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯ real-time
pm2 monit
```

---

## Ù†Ú©Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ

- âœ… Ø¯Ø³ØªÙˆØ± `update` nginx Ø±Ø§ Ø¯Ø³Øª Ù†Ù…ÛŒâ€ŒØ²Ù†Ø¯ØŒ Ù¾Ø³ SSL Ø³Ø§Ù„Ù… Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯
- âœ… Ø¯Ø³ØªÙˆØ± `deploy` Ø§Ú¯Ø± SSL Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ø´Ø¯ØŒ Ø¢Ù† Ø±Ø§ preserve Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- âš ï¸ ÙÙ‚Ø· Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø¬Ø¯Ø¯ nginxØŒ config Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯
- ğŸ”’ Certificateâ€ŒÙ‡Ø§ÛŒ SSL Ù‡Ù…ÛŒØ´Ù‡ Ø¯Ø± `/etc/letsencrypt/` Ø¨Ø§Ù‚ÛŒ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ù†Ø¯

---

## Ø®Ù„Ø§ØµÙ‡ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¹Ø¬ÙˆÙ„ ğŸ˜„

**Ø¨Ø¹Ø¯ Ø§Ø² Ù†ØµØ¨ SSLØŒ Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² `update` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:**

```bash
sudo bash marketplace-deploy.sh update
```

Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ú©Ø¯ Ø´Ù…Ø§ Ø±Ø§ update Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ø¨Ø¯ÙˆÙ† Ø§ÛŒÙ†Ú©Ù‡ SSL Ø±Ø§ Ø®Ø±Ø§Ø¨ Ú©Ù†Ø¯! ğŸ‰

